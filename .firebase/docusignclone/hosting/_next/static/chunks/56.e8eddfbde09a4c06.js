(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56],{1563:function(e,n,t){"use strict";t.d(n,{N9:function(){return m},auth:function(){return u},$2:function(){return h},HP:function(){return y},HY:function(){return x},qj:function(){return g},tO:function(){return d},u_:function(){return w}});var i=t(738),r=t(4752),a=t(5978),o=t(62);t(2495);let c=async(e,n)=>{try{let t=window.Core,i=window.Core.PDFNet;console.log(i),t.setWorkerPath("webviewer/lib/core");let r=d.ref(),a=await r.child(e).getDownloadURL(),o=async()=>{let t;let o=await i.PDFDoc.createFromURL(a);for(o.initSecurityHandler(),t=0;t<n.length;t++){console.log(n[t]);let e=await i.FDFDoc.createFromXFDF(n[t]);await o.fdfMerge(e),await o.flattenAnnotations()}let c=await o.saveMemoryBuffer(i.SDFDoc.SaveOptions.e_linearized),s=new Blob([c],{type:"application/pdf"});r.child(e).put(s).then(function(e){console.log("Uploaded the blob")})};await i.runWithCleanup(o)}catch(e){console.error(e)}},s=(0,i.ZF)({apiKey:"AIzaSyAyDmBFLsYmknmeNghLz-Xw2wLIQSMNr48",authDomain:"docusignclone.firebaseapp.com",projectId:"docusignclone",storageBucket:"docusignclone.appspot.com",messagingSenderId:"491807205117",appId:"1:491807205117:web:76f35b9931e73f4e134094"}),u=(0,r.v0)(s),l=(0,a.ad)(s),d=(0,o.cF)(s),f=new r.hJ,g=async()=>{await (0,r.rh)(u,f)},h=async(e,n)=>{if(!e)return;let t=(0,a.JU)(l,"users/".concat(e.uid));if(!(await (0,a.QT)(t)).exists){let{email:i,displayName:r,photoURL:a}=e;try{await t.set({displayName:r,email:i,photoURL:a,...n})}catch(e){console.error("Error creating user document",e)}}return p(e.uid)},p=async e=>{if(!e)return null;try{let n=(0,a.JU)(l,"users",u.currentUser.uid),t=await (0,a.QT)(n);return{uid:e,...t.data()}}catch(e){console.error("Error fetching user",e)}},m=async(e,n,t,i)=>{if(!e)return;let r=new Date,o=(0,a.JU)(l,"documentsToSign",t.split("/")[1]);(0,a.pl)(o,{uid:e,email:n,docRef:t,emails:i,xfdf:[],signedBy:[],signed:!1,requestedTime:r,signedTime:""}).then(function(e){console.log("Document written with ID: ",e)}).catch(function(e){console.error("Error adding document: ",e)})},w=async(e,n,t)=>{let i=(0,a.JU)(l,"documentsToSign",e);(0,a.QT)(i).then(async e=>{if(e.exists){let{signedBy:r,emails:o,xfdf:s,docRef:u}=e.data();if(!r.includes(n)){let e=[...r,n],l=[...s,t];if(await (0,a.r7)(i,{xfdf:l,signedBy:e}),e.length===o.length){let e=new Date;await (0,a.r7)(i,{signed:!0,signedTime:e}),c(u,l)}}}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)})},y=async e=>{let n=(0,a.hJ)(l,"documentsToSign"),t=(0,a.IO)(n,(0,a.ar)("emails","array-contains",e),(0,a.ar)("signed","==",!1)),i=(0,a.IO)(n,(0,a.ar)("signedBy","array-contains",e)),r=[],o=[];return await (0,a.PL)(i).then(function(e){e.forEach(function(e){let n=e.id;o.push(n)})}).catch(function(e){console.log("Error getting documents: ",e)}),await (0,a.PL)(t).then(function(e){e.forEach(function(e){let{docRef:n,email:t,requestedTime:i}=e.data(),a=e.id;o.includes(a)||r.push({docRef:n,email:t,requestedTime:i,docId:a})})}).catch(function(e){console.log("Error getting documents: ",e)}),r},x=async e=>{let n=(0,a.hJ)(l,"documentsToSign"),t=[],i=(0,a.IO)(n,(0,a.ar)("email","==",e),(0,a.ar)("signed","==",!0));return await (0,a.PL)(i).then(function(e){e.forEach(function(e){let{docRef:n,emails:i,signedTime:r}=e.data(),a=e.id;t.push({docRef:n,emails:i,signedTime:r,docId:a})})}).catch(function(e){console.log("Error getting documents: ",e)}),t}},1561:function(e,n,t){"use strict";t.d(n,{av:function(){return r},dy:function(){return a}});let i=(0,t(5667).oM)({name:"firebase",initialState:{user:null,docs:[],docsSigned:[]},reducers:{setUser:(e,n)=>{e.user=n.payload}}}),{setUser:r}=i.actions,a=e=>e.firebase.user;n.ZP=i.reducer},7579:function(e,n,t){"use strict";t.d(n,{El:function(){return r},En:function(){return o},K8:function(){return a}});let i=(0,t(5667).oM)({name:"assign",initialState:{signees:[]},reducers:{addSignee:(e,n)=>{e.signees=[...e.signees,{key:n.payload.key,name:n.payload.name,email:n.payload.email}]},resetSignee:(e,n)=>{console.log("resetSignee"),e.signees=[]}}}),{addSignee:r,resetSignee:a}=i.actions,o=e=>e.assign.signees;n.ZP=i.reducer},2495:function(e,n,t){"use strict";let i=(0,t(5667).oM)({name:"MergeAnnotation",initialState:{pdfNet:null},reducers:{setInstance:(e,n)=>{e.pdfNet=n.payload},resetInstance:(e,n)=>{e.pdfNet=null}}}),{setInstance:r,resetInstance:a}=i.actions;n.ZP=i.reducer},6056:function(e,n,t){"use strict";t.r(n);var i=t(7437);t(2265);var r=t(6017);t(2739);var a=t(1563),o=t(4243),c=t(1561),s=t(7579);t(9431);var u=t(7648),l=t(9376);n.default=()=>{let e=(0,o.I0)(),n=a.auth.currentUser;console.info(n);let{displayName:t,photoURL:d,email:f}=n,g=(0,l.useRouter)();return(0,i.jsxs)(r.xu,{display:"flex",direction:"row",paddingY:2,color:"lightGray",children:[(0,i.jsx)(r.sg,{span:9,children:(0,i.jsx)(r.xu,{padding:3,children:(0,i.jsx)(u.default,{href:"/",className:"profileLink",children:(0,i.jsx)(r.X6,{size:"lg",children:"Fundasta Docs Sign"})})})}),(0,i.jsx)(r.sg,{span:3,children:(0,i.jsx)(r.xu,{padding:1,children:(0,i.jsxs)("div",{className:"flex flex-row",children:[(0,i.jsx)(r.xu,{padding:1,children:(0,i.jsx)(r.qE,{name:t,size:"md",src:d})}),(0,i.jsxs)(r.xu,{children:[(0,i.jsx)(r.xv,{weight:"bold",children:t}),(0,i.jsx)(r.xv,{children:f})]}),(0,i.jsx)(r.xu,{padding:1,children:(0,i.jsx)(r.zx,{onClick:()=>{a.auth.signOut(),e((0,c.av)(null)),e((0,s.K8)()),g.push("/")},accessibilityLabel:"Sign out of your account",text:"Sign out"})})]})})})]})}},9431:function(){}}]);