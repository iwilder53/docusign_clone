(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743,56],{6743:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return S}});var t=i(7437),s=i(2265),r=i(4243),c=i(1563),o=i(6017);i(2739);var l=i(7648),a=i(9376),d=i(4752),u=()=>{let[e,n]=(0,s.useState)(""),[i,r]=(0,s.useState)(""),[u,h]=(0,s.useState)(null),x=(0,a.useRouter)(),g=async(e,n,i)=>{console.info("email: ".concat(n," pass : ").concat(i)),await (0,d.e5)(c.auth,n,i).catch(e=>{h("Error signing in with password and email!"),console.error("Error signing in with password and email",e)})};return(0,t.jsx)("div",{className:"m-16 w-1/3",children:(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsxs)(o.W2,{children:[(0,t.jsxs)(o.xu,{padding:1,children:[null!==u&&(0,t.jsx)(o.FN,{text:u}),(0,t.jsx)(o.X6,{size:"md",children:"Sign in"})]}),(0,t.jsxs)("form",{children:[(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.nv,{id:"email",onChange:e=>n(e.value),placeholder:"Enter your email",label:"Email",value:e,type:"email"})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.nv,{id:"password",onChange:e=>r(e.value),placeholder:"Enter your password",label:"Password",value:i,type:"password"})})]}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.zx,{onClick:n=>{g(n,e,i),x.push("/")},text:"Sign in",color:"blue",inline:!0})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.xv,{children:"or"})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.zx,{onClick:c.qj,text:"Sign in with Google",color:"red",inline:!0})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.xv,{children:"Don't have an account?"})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(l.default,{href:"Auth/SignUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(l.default,{href:"Auth/ResetPassword",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})})]})})})},h=()=>(0,t.jsx)(o.xu,{display:"flex",direction:"row",paddingY:2,color:"lightGray",children:(0,t.jsx)(o.sg,{span:10,children:(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsx)(o.X6,{size:"lg",children:" Fundasta Docs Sign"})})})}),x=i(6056),g=i(1561),f=i(9833),j=()=>{let{email:e}=(0,r.v9)(g.dy),n=(0,a.useRouter)(),[i,l]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),h=(0,r.I0)();return(0,s.useEffect)(()=>{setTimeout(async function(){l(await (0,c.HP)(e)),u(!1)},1e3)},[e]),(0,t.jsx)("div",{children:d?(0,t.jsx)(o.$j,{show:d,accessibilityLabel:"spinner"}):(0,t.jsx)("div",{children:i.length>0?(0,t.jsxs)(o.iA,{children:[(0,t.jsx)(o.iA.Header,{children:(0,t.jsxs)(o.iA.Row,{children:[(0,t.jsx)(o.iA.HeaderCell,{children:(0,t.jsx)(o.xv,{weight:"bold",children:"From"})}),(0,t.jsx)(o.iA.HeaderCell,{children:(0,t.jsx)(o.xv,{weight:"bold",children:"When"})})]})}),(0,t.jsx)(o.iA.Body,{children:i.map(e=>(0,t.jsxs)(o.iA.Row,{children:[(0,t.jsx)(o.iA.Cell,{children:(0,t.jsx)(o.xv,{children:e.email})}),(0,t.jsx)(o.iA.Cell,{children:(0,t.jsx)(o.xv,{children:e.requestedTime?new Date(1e3*e.requestedTime.seconds).toDateString():""})}),(0,t.jsx)(o.iA.Cell,{children:(0,t.jsx)(o.zx,{onClick:i=>{let{docRef:t,docId:s}=e;h((0,f.Ak)({docRef:t,docId:s})),n.push("/SignDocument")},text:"Sign",color:"blue",inline:!0})})]},e.docRef))})]}):(0,t.jsx)("p",{className:" text-gray-900",children:"You do not have any documents to sign"})})})},p=i(9563),w=()=>{let{email:e}=(0,r.v9)(g.dy),[n,i]=(0,s.useState)([]),[l,d]=(0,s.useState)(!0),u=(0,a.useRouter)(),h=(0,r.I0)();return(0,s.useEffect)(()=>{setTimeout(async function(){i(await (0,c.HY)(e)),d(!1)},1e3)},[e]),(0,t.jsx)("div",{children:l?(0,t.jsx)(o.$j,{show:l,accessibilityLabel:"spinner"}):(0,t.jsx)("div",{children:n.length>0?(0,t.jsxs)(o.iA,{children:[(0,t.jsx)(o.iA.Header,{children:(0,t.jsxs)(o.iA.Row,{children:[(0,t.jsx)(o.iA.HeaderCell,{children:(0,t.jsx)(o.xv,{weight:"bold",children:"From"})}),(0,t.jsx)(o.iA.HeaderCell,{children:(0,t.jsx)(o.xv,{weight:"bold",children:"When"})})]})}),(0,t.jsx)(o.iA.Body,{children:n.map(e=>(0,t.jsxs)(o.iA.Row,{children:[(0,t.jsx)(o.iA.Cell,{children:e.emails.map(e=>(0,t.jsx)(o.xv,{children:e},e))}),(0,t.jsx)(o.iA.Cell,{children:(0,t.jsx)(o.xv,{children:e.signedTime?new Date(1e3*e.signedTime.seconds).toDateString():""})}),(0,t.jsx)(o.iA.Cell,{children:(0,t.jsx)(o.zx,{onClick:n=>{let{docRef:i,docId:t}=e;h((0,p.w5)({docRef:i,docId:t})),u.push("/ViewDocument")},text:"View",color:"blue",inline:!0})})]},e.docRef))})]}):(0,t.jsx)("p",{className:" text-gray-900",children:"You do not have any documents to review"})})})},m=()=>{let e=(0,r.I0)(),n=(0,a.useRouter)();return(0,s.useEffect)(()=>{e((0,p.Sj)()),e((0,f.GW)())},[e]),(0,t.jsxs)("div",{children:[(0,t.jsx)(x.default,{}),(0,t.jsxs)(o.W2,{children:[(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsx)(o.X6,{size:"md",children:"Sign Documents"})}),(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsx)(j,{})}),(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsx)(o.X6,{size:"md",children:"Prepare Document"})}),(0,t.jsx)(o.xu,{padding:2,children:(0,t.jsx)(o.zx,{onClick:e=>{n.push("/AssignUsers")},text:"Prepare Document for Signing",color:"blue",inline:!0})}),(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsx)(o.X6,{size:"md",children:"Review Signed Documents"})}),(0,t.jsx)(o.xu,{padding:3,children:(0,t.jsx)(w,{})})]})]})};i(2341);var y=i(166);let v=()=>{let e=(0,r.v9)(g.dy),n=(0,r.I0)();return(0,s.useEffect)(()=>{(0,d.Aj)(c.auth,async e=>{if(!c.auth.currentUser)return;console.info(await (0,c.$2)(e)),console.info(e),console.info("auth: ".concat(c.auth.currentUser));let{uid:i,displayName:t,email:s,photoURL:r}=c.auth.currentUser;n((0,g.av)({uid:i,displayName:t,email:s,photoURL:r}))})},[n]),e?(0,t.jsx)(m,{path:"/"}):(0,t.jsxs)("div",{children:[(0,t.jsx)(h,{}),(0,t.jsx)(u,{path:"/"})]})};var S=(0,y.default)(()=>Promise.resolve(v),{ssr:!1})},1563:function(e,n,i){"use strict";i.d(n,{N9:function(){return j},auth:function(){return a},$2:function(){return g},HP:function(){return w},HY:function(){return m},qj:function(){return x},tO:function(){return u},u_:function(){return p}});var t=i(738),s=i(4752),r=i(5978),c=i(62);i(2495);let o=async(e,n)=>{try{let i=window.Core,t=window.Core.PDFNet;console.log(t),i.setWorkerPath("webviewer/lib/core");let s=u.ref(),r=await s.child(e).getDownloadURL(),c=async()=>{let i;let c=await t.PDFDoc.createFromURL(r);for(c.initSecurityHandler(),i=0;i<n.length;i++){console.log(n[i]);let e=await t.FDFDoc.createFromXFDF(n[i]);await c.fdfMerge(e),await c.flattenAnnotations()}let o=await c.saveMemoryBuffer(t.SDFDoc.SaveOptions.e_linearized),l=new Blob([o],{type:"application/pdf"});s.child(e).put(l).then(function(e){console.log("Uploaded the blob")})};await t.runWithCleanup(c)}catch(e){console.error(e)}},l=(0,t.ZF)({apiKey:"AIzaSyAyDmBFLsYmknmeNghLz-Xw2wLIQSMNr48",authDomain:"docusignclone.firebaseapp.com",projectId:"docusignclone",storageBucket:"docusignclone.appspot.com",messagingSenderId:"491807205117",appId:"1:491807205117:web:76f35b9931e73f4e134094"}),a=(0,s.v0)(l),d=(0,r.ad)(l),u=(0,c.cF)(l),h=new s.hJ,x=async()=>{await (0,s.rh)(a,h)},g=async(e,n)=>{if(!e)return;let i=(0,r.JU)(d,"users/".concat(e.uid));if(!(await (0,r.QT)(i)).exists){let{email:t,displayName:s,photoURL:r}=e;try{await i.set({displayName:s,email:t,photoURL:r,...n})}catch(e){console.error("Error creating user document",e)}}return f(e.uid)},f=async e=>{if(!e)return null;try{let n=(0,r.JU)(d,"users",a.currentUser.uid),i=await (0,r.QT)(n);return{uid:e,...i.data()}}catch(e){console.error("Error fetching user",e)}},j=async(e,n,i,t)=>{if(!e)return;let s=new Date,c=(0,r.JU)(d,"documentsToSign",i.split("/")[1]);(0,r.pl)(c,{uid:e,email:n,docRef:i,emails:t,xfdf:[],signedBy:[],signed:!1,requestedTime:s,signedTime:""}).then(function(e){console.log("Document written with ID: ",e)}).catch(function(e){console.error("Error adding document: ",e)})},p=async(e,n,i)=>{let t=(0,r.JU)(d,"documentsToSign",e);(0,r.QT)(t).then(async e=>{if(e.exists){let{signedBy:s,emails:c,xfdf:l,docRef:a}=e.data();if(!s.includes(n)){let e=[...s,n],d=[...l,i];if(await (0,r.r7)(t,{xfdf:d,signedBy:e}),e.length===c.length){let e=new Date;await (0,r.r7)(t,{signed:!0,signedTime:e}),o(a,d)}}}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)})},w=async e=>{let n=(0,r.hJ)(d,"documentsToSign"),i=(0,r.IO)(n,(0,r.ar)("emails","array-contains",e),(0,r.ar)("signed","==",!1)),t=(0,r.IO)(n,(0,r.ar)("signedBy","array-contains",e)),s=[],c=[];return await (0,r.PL)(t).then(function(e){e.forEach(function(e){let n=e.id;c.push(n)})}).catch(function(e){console.log("Error getting documents: ",e)}),await (0,r.PL)(i).then(function(e){e.forEach(function(e){let{docRef:n,email:i,requestedTime:t}=e.data(),r=e.id;c.includes(r)||s.push({docRef:n,email:i,requestedTime:t,docId:r})})}).catch(function(e){console.log("Error getting documents: ",e)}),s},m=async e=>{let n=(0,r.hJ)(d,"documentsToSign"),i=[],t=(0,r.IO)(n,(0,r.ar)("email","==",e),(0,r.ar)("signed","==",!0));return await (0,r.PL)(t).then(function(e){e.forEach(function(e){let{docRef:n,emails:t,signedTime:s}=e.data(),r=e.id;i.push({docRef:n,emails:t,signedTime:s,docId:r})})}).catch(function(e){console.log("Error getting documents: ",e)}),i}},1561:function(e,n,i){"use strict";i.d(n,{av:function(){return s},dy:function(){return r}});let t=(0,i(5667).oM)({name:"firebase",initialState:{user:null,docs:[],docsSigned:[]},reducers:{setUser:(e,n)=>{e.user=n.payload}}}),{setUser:s}=t.actions,r=e=>e.firebase.user;n.ZP=t.reducer},7579:function(e,n,i){"use strict";i.d(n,{El:function(){return s},En:function(){return c},K8:function(){return r}});let t=(0,i(5667).oM)({name:"assign",initialState:{signees:[]},reducers:{addSignee:(e,n)=>{e.signees=[...e.signees,{key:n.payload.key,name:n.payload.name,email:n.payload.email}]},resetSignee:(e,n)=>{console.log("resetSignee"),e.signees=[]}}}),{addSignee:s,resetSignee:r}=t.actions,c=e=>e.assign.signees;n.ZP=t.reducer},2495:function(e,n,i){"use strict";let t=(0,i(5667).oM)({name:"MergeAnnotation",initialState:{pdfNet:null},reducers:{setInstance:(e,n)=>{e.pdfNet=n.payload},resetInstance:(e,n)=>{e.pdfNet=null}}}),{setInstance:s,resetInstance:r}=t.actions;n.ZP=t.reducer},6056:function(e,n,i){"use strict";i.r(n);var t=i(7437);i(2265);var s=i(6017);i(2739);var r=i(1563),c=i(4243),o=i(1561),l=i(7579);i(9431);var a=i(7648),d=i(9376);n.default=()=>{let e=(0,c.I0)(),n=r.auth.currentUser;console.info(n);let{displayName:i,photoURL:u,email:h}=n,x=(0,d.useRouter)();return(0,t.jsxs)(s.xu,{display:"flex",direction:"row",paddingY:2,color:"lightGray",children:[(0,t.jsx)(s.sg,{span:9,children:(0,t.jsx)(s.xu,{padding:3,children:(0,t.jsx)(a.default,{href:"/",className:"profileLink",children:(0,t.jsx)(s.X6,{size:"lg",children:"Fundasta Docs Sign"})})})}),(0,t.jsx)(s.sg,{span:3,children:(0,t.jsx)(s.xu,{padding:1,children:(0,t.jsxs)("div",{className:"flex flex-row",children:[(0,t.jsx)(s.xu,{padding:1,children:(0,t.jsx)(s.qE,{name:i,size:"md",src:u})}),(0,t.jsxs)(s.xu,{children:[(0,t.jsx)(s.xv,{weight:"bold",children:i}),(0,t.jsx)(s.xv,{children:h})]}),(0,t.jsx)(s.xu,{padding:1,children:(0,t.jsx)(s.zx,{onClick:()=>{r.auth.signOut(),e((0,o.av)(null)),e((0,l.K8)()),x.push("/")},accessibilityLabel:"Sign out of your account",text:"Sign out"})})]})})})]})}},9833:function(e,n,i){"use strict";i.d(n,{Ak:function(){return s},GW:function(){return r},f5:function(){return c}});let t=(0,i(5667).oM)({name:"signDoc",initialState:{docToSign:null},reducers:{setDocToSign:(e,n)=>{e.docToSign=n.payload},resetDocToSign:(e,n)=>{e.docToSign=null}}}),{setDocToSign:s,resetDocToSign:r}=t.actions,c=e=>e.signDoc.docToSign;n.ZP=t.reducer},9563:function(e,n,i){"use strict";i.d(n,{Sj:function(){return r},Uq:function(){return c},w5:function(){return s}});let t=(0,i(5667).oM)({name:"viewDoc",initialState:{docToView:null},reducers:{setDocToView:(e,n)=>{e.docToView=n.payload},resetDocToView:(e,n)=>{e.docToView=null}}}),{setDocToView:s,resetDocToView:r}=t.actions,c=e=>e.viewDoc.docToView;n.ZP=t.reducer},2341:function(){},9431:function(){}}]);